Windows fatal exception: code 0xc0000139

Thread 0x0000ba6c (most recent call first):
  File "<frozen importlib._bootstrap>", line 488 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 1320 in create_module
  File "<frozen importlib._bootstrap>", line 813 in module_from_spec
  File "<frozen importlib._bootstrap>", line 921 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 1331 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1360 in _find_and_load
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pyarrow\__init__.py", line 65 in <module>
  File "<frozen importlib._bootstrap>", line 488 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 1026 in exec_module
  File "<frozen importlib._bootstrap>", line 935 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 1331 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1360 in _find_and_load
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pandas\compat\pyarrow.py", line 8 in <module>
  File "<frozen importlib._bootstrap>", line 488 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 1026 in exec_module
  File "<frozen importlib._bootstrap>", line 935 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 1331 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1360 in _find_and_load
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pandas\compat\__init__.py", line 27 in <module>
  File "<frozen importlib._bootstrap>", line 488 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 1026 in exec_module
  File "<frozen importlib._bootstrap>", line 935 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 1331 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1360 in _find_and_load
  File Windows fatal exception: code 0xc0000139

"C:\Users\aboro\miniconda3\Lib\site-packages\pandas\__init__.py", line 26 in <module>
  File "<frozen importlib._bootstrap>", line 488 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 1026 in exec_module
  File "<frozen importlib._bootstrap>", line 935 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 1331 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1360 in _find_and_load
  File "C:\Users\aboro\Downloads\test\dec25bmlops_int_weather\tests\test_predict.py", line 5 in <module>
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\assertion\rewrite.py", line 186 in exec_module
  File "<frozen importlib._bootstrap>", line 935 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 1331 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1360 in _find_and_load
  File "<frozen importlib._bootstrap>", line 1387 in _gcd_import
  File "C:\Users\aboro\miniconda3\Lib\importlib\__init__.py", line 88 in import_module
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\pathlib.py", line 587 in import_path
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\python.py", line 498 in importtestmodule
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\python.py", line 551 in _getobj
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\python.py", line 280 in obj
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\python.py", line 567 in _register_setup_module_fixture
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\python.py", line 554 in collect
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\runner.py", line 389 in collect
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\runner.py", line 344 in from_call
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\runner.py", line 391 in pytest_make_collect_report
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_callers.py", line 103 in _multicall
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_manager.py", line 120 in _hookexec
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_hooks.py", line 513 in __call__
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\runner.py", line 567 in collect_one_node
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\main.py", line 839 in _collect_one_node
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\main.py", line 974 in genitems
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\main.py", line 979 in genitems
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\main.py", line 813 in perform_collect
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\main.py", line 353 in pytest_collection
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_callers.py", line 103 in _multicall
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_manager.py", line 120 in _hookexec
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_hooks.py", line 513 in __call__
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\main.py", line 342 in _main
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\main.py", line 289 in wrap_session
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\main.py", line 336 in pytest_cmdline_main
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_callers.py", line 103 in _multicall
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_manager.py", line 120 in _hookexec
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_hooks.py", line 513 in __call__
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\config\__init__.py", line 175 in main
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\config\__init__.py", line 201 in console_main
  File "C:\Users\aboro\miniconda3\Scripts\pytest.exe\__main__.py", line 6 in <module>
  File "<frozen runpy>", line 88 in _run_code
  File "<frozen runpy>", line 198 in _run_module_as_main
Windows fatal exception: code 0xc0000139

Thread 0x0000ba6c (most recent call first):
  File "<frozen importlib._bootstrap>", line 488 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 1320 in create_module
  File "<frozen importlib._bootstrap>", line 813 in module_from_spec
  File "<frozen importlib._bootstrap>", line 921 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 1331 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1360 in _find_and_load
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pyarrow\__init__.py", line 65 in <module>
  File "<frozen importlib._bootstrap>", line 488 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 1026 in exec_module
  File "<frozen importlib._bootstrap>", line 935 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 1331 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1360 in _find_and_load
  File "<frozen importlib._bootstrap>", line 488 in _call_with_frames_removed
Windows fatal exception: code 0xc0000139

  File "<frozen importlib._bootstrap_external>", line 1328 in exec_module
  File "<frozen importlib._bootstrap>", line 935 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 1331 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1360 in _find_and_load
  File "<frozen importlib._bootstrap>", line 488 in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 1415 in _handle_fromlist
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pandas\core\dtypes\dtypes.py", line 24 in <module>
  File "<frozen importlib._bootstrap>", line 488 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 1026 in exec_module
  File "<frozen importlib._bootstrap>", line 935 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 1331 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1360 in _find_and_load
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pandas\core\api.py", line 9 in <module>
  File "<frozen importlib._bootstrap>", line 488 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 1026 in exec_module
  File "<frozen importlib._bootstrap>", line 935 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 1331 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1360 in _find_and_load
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pandas\__init__.py", line 49 in <module>
  File "<frozen importlib._bootstrap>", line 488 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 1026 in exec_module
  File "<frozen importlib._bootstrap>", line 935 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 1331 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1360 in _find_and_load
  File "C:\Users\aboro\Downloads\test\dec25bmlops_int_weather\tests\test_predict.py", line 5 in <module>
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\assertion\rewrite.py", line 186 in exec_module
  File "<frozen importlib._bootstrap>", line 935 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 1331 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1360 in _find_and_load
  File "<frozen importlib._bootstrap>", line 1387 in _gcd_import
  File "C:\Users\aboro\miniconda3\Lib\importlib\__init__.py", line 88 in import_module
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\pathlib.py", line 587 in import_path
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\python.py", line 498 in importtestmodule
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\python.py", line 551 in _getobj
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\python.py", line 280 in obj
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\python.py", line 567 in _register_setup_module_fixture
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\python.py", line 554 in collect
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\runner.py", line 389 in collect
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\runner.py", line 344 in from_call
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\runner.py", line 391 in pytest_make_collect_report
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_callers.py", line 103 in _multicall
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_manager.py", line 120 in _hookexec
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_hooks.py", line 513 in __call__
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\runner.py", line 567 in collect_one_node
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\main.py", line 839 in _collect_one_node
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\main.py", line 974 in genitems
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\main.py", line 979 in genitems
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\main.py", line 813 in perform_collect
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\main.py", line 353 in pytest_collection
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_callers.py", line 103 in _multicall
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_manager.py", line 120 in _hookexec
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_hooks.py", line 513 in __call__
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\main.py", line 342 in _main
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\main.py", line 289 in wrap_session
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\main.py", line 336 in pytest_cmdline_main
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_callers.py", line 103 in _multicall
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_manager.py", line 120 in _hookexec
  File "C:\Users\aboro\miniconda3\Lib\site-packages\pluggy\_hooks.py", line 513 in __call__
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\config\__init__.py", line 175 in main
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_pytest\config\__init__.py", line 201 in console_main
  File "C:\Users\aboro\miniconda3\Scripts\pytest.exe\__main__.py", line 6 in <module>
  File "<frozen runpy>", line 88 in _run_code
  File "<frozen runpy>", line 198 in _run_module_as_main
.FFFFF.                                                                  [100%]
================================== FAILURES ===================================
___________________ TestServiceSecurity.test_login_failure ____________________

self = <test_security_verification.TestServiceSecurity testMethod=test_login_failure>

    def test_login_failure(self):
        with self.assertRaises(bentoml.exceptions.BentoMLException) as cm:
>           self.service.login("testuser", "wrongpass")

tests\test_security_verification.py:50:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    @functools.wraps(self.func)
    def wrapped(*args: P.args, **kwargs: P.kwargs) -> R:
        # Extract the default values from `Field` if any
        for i, param in enumerate(params):
            if i < len(args) or param.name in kwargs:
                # skip the arguments that are already provided
                continue
            if isinstance(field := param.default, FieldInfo):
                if field.default is not PydanticUndefined:
                    kwargs[param.name] = field.default
                elif field.default_factory not in (None, PydanticUndefined):
                    kwargs[param.name] = field.default_factory()
>       return self.func(instance, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       TypeError: RainPredictionService.login() takes 2 positional arguments but 3 were given

..\..\..\miniconda3\Lib\site-packages\_bentoml_sdk\method.py:177: TypeError
------------------------------ Captured log call ------------------------------
WARNING  bentoml._internal.runner.runner:runner.py:306 'Runner.init_local' is for debugging and testing only. Make sure to remove it before deploying to production.
___________________ TestServiceSecurity.test_login_success ____________________

self = <test_security_verification.TestServiceSecurity testMethod=test_login_success>

    def setUp(self):
        # Patch pickle.load to return a mock model
        self.pickle_patcher = patch("pickle.load")
        self.mock_pickle_load = self.pickle_patcher.start()

        self.mock_model = MagicMock()
        # Setup mock model behavior
        self.mock_model.predict.return_value = [0]
        self.mock_model.predict_proba.return_value = [[0.8, 0.2]]
        self.mock_pickle_load.return_value = self.mock_model

        # Initialize service
>       self.service = RainPredictionService()
                       ^^^^^^^^^^^^^^^^^^^^^^^

tests\test_security_verification.py:37:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
..\..\..\miniconda3\Lib\site-packages\_bentoml_sdk\service\factory.py:409: in __call__
    instance = self.inner()
               ^^^^^^^^^^^^
src\service.py:102: in __init__
    xgboost_runner.init_local()
..\..\..\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py:323: in init_local
    raise e
..\..\..\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py:313: in init_local
    self._set_handle(LocalRunnerRef)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = Runner(name='rain_prediction_model', models=[Model(tag="rain_prediction_model:7v7sskh3ao45d2ch", path="C:\Users\aboro\...t_params={}, _runner_handle=<bentoml._internal.runner.runner_handle.local.LocalRunnerRef object at 0x00000227A4171A90>)
handle_class = <class 'bentoml._internal.runner.runner_handle.local.LocalRunnerRef'>
args = (), kwargs = {}

    def _set_handle(
        self, handle_class: type[RunnerHandle], *args: t.Any, **kwargs: t.Any
    ) -> None:
        if not isinstance(self._runner_handle, DummyRunnerHandle):
>           raise StateException("Runner already initialized")
E           bentoml.exceptions.StateException: Runner already initialized

..\..\..\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py:153: StateException
------------------------------ Captured log call ------------------------------
WARNING  bentoml._internal.runner.runner:runner.py:306 'Runner.init_local' is for debugging and testing only. Make sure to remove it before deploying to production.
ERROR    bentoml._internal.runner.runner:runner.py:317 An exception occurred while instantiating runner 'rain_prediction_model', see details below:
ERROR    bentoml._internal.runner.runner:runner.py:321 Traceback (most recent call last):
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 313, in init_local
    self._set_handle(LocalRunnerRef)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 153, in _set_handle
    raise StateException("Runner already initialized")
bentoml.exceptions.StateException: Runner already initialized

ERROR    bentoml.serve:factory.py:415 Initializing service error
Traceback (most recent call last):
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_bentoml_sdk\service\factory.py", line 409, in __call__
    instance = self.inner()
  File "C:\Users\aboro\Downloads\test\dec25bmlops_int_weather\src\service.py", line 102, in __init__
    xgboost_runner.init_local()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 323, in init_local
    raise e
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 313, in init_local
    self._set_handle(LocalRunnerRef)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 153, in _set_handle
    raise StateException("Runner already initialized")
bentoml.exceptions.StateException: Runner already initialized
_______________ TestServiceSecurity.test_predict_invalid_token ________________

self = <test_security_verification.TestServiceSecurity testMethod=test_predict_invalid_token>

    def setUp(self):
        # Patch pickle.load to return a mock model
        self.pickle_patcher = patch("pickle.load")
        self.mock_pickle_load = self.pickle_patcher.start()

        self.mock_model = MagicMock()
        # Setup mock model behavior
        self.mock_model.predict.return_value = [0]
        self.mock_model.predict_proba.return_value = [[0.8, 0.2]]
        self.mock_pickle_load.return_value = self.mock_model

        # Initialize service
>       self.service = RainPredictionService()
                       ^^^^^^^^^^^^^^^^^^^^^^^

tests\test_security_verification.py:37:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
..\..\..\miniconda3\Lib\site-packages\_bentoml_sdk\service\factory.py:409: in __call__
    instance = self.inner()
               ^^^^^^^^^^^^
src\service.py:102: in __init__
    xgboost_runner.init_local()
..\..\..\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py:323: in init_local
    raise e
..\..\..\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py:313: in init_local
    self._set_handle(LocalRunnerRef)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = Runner(name='rain_prediction_model', models=[Model(tag="rain_prediction_model:7v7sskh3ao45d2ch", path="C:\Users\aboro\...t_params={}, _runner_handle=<bentoml._internal.runner.runner_handle.local.LocalRunnerRef object at 0x00000227A4171A90>)
handle_class = <class 'bentoml._internal.runner.runner_handle.local.LocalRunnerRef'>
args = (), kwargs = {}

    def _set_handle(
        self, handle_class: type[RunnerHandle], *args: t.Any, **kwargs: t.Any
    ) -> None:
        if not isinstance(self._runner_handle, DummyRunnerHandle):
>           raise StateException("Runner already initialized")
E           bentoml.exceptions.StateException: Runner already initialized

..\..\..\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py:153: StateException
------------------------------ Captured log call ------------------------------
WARNING  bentoml._internal.runner.runner:runner.py:306 'Runner.init_local' is for debugging and testing only. Make sure to remove it before deploying to production.
ERROR    bentoml._internal.runner.runner:runner.py:317 An exception occurred while instantiating runner 'rain_prediction_model', see details below:
ERROR    bentoml._internal.runner.runner:runner.py:321 Traceback (most recent call last):
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 313, in init_local
    self._set_handle(LocalRunnerRef)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 153, in _set_handle
    raise StateException("Runner already initialized")
bentoml.exceptions.StateException: Runner already initialized

ERROR    bentoml.serve:factory.py:415 Initializing service error
Traceback (most recent call last):
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_bentoml_sdk\service\factory.py", line 409, in __call__
    instance = self.inner()
  File "C:\Users\aboro\Downloads\test\dec25bmlops_int_weather\src\service.py", line 102, in __init__
    xgboost_runner.init_local()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 323, in init_local
    raise e
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 313, in init_local
    self._set_handle(LocalRunnerRef)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 153, in _set_handle
    raise StateException("Runner already initialized")
bentoml.exceptions.StateException: Runner already initialized
__________________ TestServiceSecurity.test_predict_no_token __________________

self = <test_security_verification.TestServiceSecurity testMethod=test_predict_no_token>

    def setUp(self):
        # Patch pickle.load to return a mock model
        self.pickle_patcher = patch("pickle.load")
        self.mock_pickle_load = self.pickle_patcher.start()

        self.mock_model = MagicMock()
        # Setup mock model behavior
        self.mock_model.predict.return_value = [0]
        self.mock_model.predict_proba.return_value = [[0.8, 0.2]]
        self.mock_pickle_load.return_value = self.mock_model

        # Initialize service
>       self.service = RainPredictionService()
                       ^^^^^^^^^^^^^^^^^^^^^^^

tests\test_security_verification.py:37:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
..\..\..\miniconda3\Lib\site-packages\_bentoml_sdk\service\factory.py:409: in __call__
    instance = self.inner()
               ^^^^^^^^^^^^
src\service.py:102: in __init__
    xgboost_runner.init_local()
..\..\..\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py:323: in init_local
    raise e
..\..\..\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py:313: in init_local
    self._set_handle(LocalRunnerRef)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = Runner(name='rain_prediction_model', models=[Model(tag="rain_prediction_model:7v7sskh3ao45d2ch", path="C:\Users\aboro\...t_params={}, _runner_handle=<bentoml._internal.runner.runner_handle.local.LocalRunnerRef object at 0x00000227A4171A90>)
handle_class = <class 'bentoml._internal.runner.runner_handle.local.LocalRunnerRef'>
args = (), kwargs = {}

    def _set_handle(
        self, handle_class: type[RunnerHandle], *args: t.Any, **kwargs: t.Any
    ) -> None:
        if not isinstance(self._runner_handle, DummyRunnerHandle):
>           raise StateException("Runner already initialized")
E           bentoml.exceptions.StateException: Runner already initialized

..\..\..\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py:153: StateException
------------------------------ Captured log call ------------------------------
WARNING  bentoml._internal.runner.runner:runner.py:306 'Runner.init_local' is for debugging and testing only. Make sure to remove it before deploying to production.
ERROR    bentoml._internal.runner.runner:runner.py:317 An exception occurred while instantiating runner 'rain_prediction_model', see details below:
ERROR    bentoml._internal.runner.runner:runner.py:321 Traceback (most recent call last):
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 313, in init_local
    self._set_handle(LocalRunnerRef)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 153, in _set_handle
    raise StateException("Runner already initialized")
bentoml.exceptions.StateException: Runner already initialized

ERROR    bentoml.serve:factory.py:415 Initializing service error
Traceback (most recent call last):
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_bentoml_sdk\service\factory.py", line 409, in __call__
    instance = self.inner()
  File "C:\Users\aboro\Downloads\test\dec25bmlops_int_weather\src\service.py", line 102, in __init__
    xgboost_runner.init_local()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 323, in init_local
    raise e
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 313, in init_local
    self._set_handle(LocalRunnerRef)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 153, in _set_handle
    raise StateException("Runner already initialized")
bentoml.exceptions.StateException: Runner already initialized
________________ TestServiceSecurity.test_predict_valid_token _________________

self = <test_security_verification.TestServiceSecurity testMethod=test_predict_valid_token>

    def setUp(self):
        # Patch pickle.load to return a mock model
        self.pickle_patcher = patch("pickle.load")
        self.mock_pickle_load = self.pickle_patcher.start()

        self.mock_model = MagicMock()
        # Setup mock model behavior
        self.mock_model.predict.return_value = [0]
        self.mock_model.predict_proba.return_value = [[0.8, 0.2]]
        self.mock_pickle_load.return_value = self.mock_model

        # Initialize service
>       self.service = RainPredictionService()
                       ^^^^^^^^^^^^^^^^^^^^^^^

tests\test_security_verification.py:37:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
..\..\..\miniconda3\Lib\site-packages\_bentoml_sdk\service\factory.py:409: in __call__
    instance = self.inner()
               ^^^^^^^^^^^^
src\service.py:102: in __init__
    xgboost_runner.init_local()
..\..\..\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py:323: in init_local
    raise e
..\..\..\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py:313: in init_local
    self._set_handle(LocalRunnerRef)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = Runner(name='rain_prediction_model', models=[Model(tag="rain_prediction_model:7v7sskh3ao45d2ch", path="C:\Users\aboro\...t_params={}, _runner_handle=<bentoml._internal.runner.runner_handle.local.LocalRunnerRef object at 0x00000227A4171A90>)
handle_class = <class 'bentoml._internal.runner.runner_handle.local.LocalRunnerRef'>
args = (), kwargs = {}

    def _set_handle(
        self, handle_class: type[RunnerHandle], *args: t.Any, **kwargs: t.Any
    ) -> None:
        if not isinstance(self._runner_handle, DummyRunnerHandle):
>           raise StateException("Runner already initialized")
E           bentoml.exceptions.StateException: Runner already initialized

..\..\..\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py:153: StateException
------------------------------ Captured log call ------------------------------
WARNING  bentoml._internal.runner.runner:runner.py:306 'Runner.init_local' is for debugging and testing only. Make sure to remove it before deploying to production.
ERROR    bentoml._internal.runner.runner:runner.py:317 An exception occurred while instantiating runner 'rain_prediction_model', see details below:
ERROR    bentoml._internal.runner.runner:runner.py:321 Traceback (most recent call last):
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 313, in init_local
    self._set_handle(LocalRunnerRef)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 153, in _set_handle
    raise StateException("Runner already initialized")
bentoml.exceptions.StateException: Runner already initialized

ERROR    bentoml.serve:factory.py:415 Initializing service error
Traceback (most recent call last):
  File "C:\Users\aboro\miniconda3\Lib\site-packages\_bentoml_sdk\service\factory.py", line 409, in __call__
    instance = self.inner()
  File "C:\Users\aboro\Downloads\test\dec25bmlops_int_weather\src\service.py", line 102, in __init__
    xgboost_runner.init_local()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 323, in init_local
    raise e
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 313, in init_local
    self._set_handle(LocalRunnerRef)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\runner\runner.py", line 153, in _set_handle
    raise StateException("Runner already initialized")
bentoml.exceptions.StateException: Runner already initialized
============================== warnings summary ===============================
src\api\main.py:27
  C:\Users\aboro\Downloads\test\dec25bmlops_int_weather\src\api\main.py:27: DeprecationWarning:
          on_event is deprecated, use lifespan event handlers instead.

          Read more about it in the
          [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).

    @app.on_event("startup")

..\..\..\miniconda3\Lib\site-packages\fastapi\applications.py:4575
  C:\Users\aboro\miniconda3\Lib\site-packages\fastapi\applications.py:4575: DeprecationWarning:
          on_event is deprecated, use lifespan event handlers instead.

          Read more about it in the
          [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).

    return self.router.on_event(event_type)

..\..\..\miniconda3\Lib\site-packages\bentoml\_internal\models\model.py:353
  C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\models\model.py:353: BentoMLDeprecationWarning: `get_runnable` is deprecated since BentoML v1.4 and will be removed in a future version. Use `get_service` instead.
    self._runnable = self.info.imported_module.get_runnable(self)

..\..\..\miniconda3\Lib\site-packages\bentoml\_internal\models\model.py:340
  C:\Users\aboro\miniconda3\Lib\site-packages\bentoml\_internal\models\model.py:340: BentoMLDeprecationWarning: `Runner` is deprecated since BentoML v1.4 and will be removed in a future version. Please upgrade to new style services.
    return Runner(

..\..\..\miniconda3\Lib\site-packages\_bentoml_sdk\io_models.py:158
..\..\..\miniconda3\Lib\site-packages\_bentoml_sdk\io_models.py:158
..\..\..\miniconda3\Lib\site-packages\_bentoml_sdk\io_models.py:158
..\..\..\miniconda3\Lib\site-packages\_bentoml_sdk\io_models.py:158
..\..\..\miniconda3\Lib\site-packages\_bentoml_sdk\io_models.py:158
..\..\..\miniconda3\Lib\site-packages\_bentoml_sdk\io_models.py:158
..\..\..\miniconda3\Lib\site-packages\_bentoml_sdk\io_models.py:158
  C:\Users\aboro\miniconda3\Lib\site-packages\_bentoml_sdk\io_models.py:158: PydanticDeprecatedSince211: The `__get_pydantic_core_schema__` method of the `BaseModel` class is deprecated. If you are calling `super().__get_pydantic_core_schema__` when overriding the method on a Pydantic model, consider using `handler(source)` instead. However, note that overriding this method on models can lead to unexpected side effects. Deprecated in Pydantic V2.11 to be removed in V3.0.
    return super().__get_pydantic_core_schema__(source, handler)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED tests/test_security_verification.py::TestServiceSecurity::test_login_failure
FAILED tests/test_security_verification.py::TestServiceSecurity::test_login_success
FAILED tests/test_security_verification.py::TestServiceSecurity::test_predict_invalid_token
FAILED tests/test_security_verification.py::TestServiceSecurity::test_predict_no_token
FAILED tests/test_security_verification.py::TestServiceSecurity::test_predict_valid_token
5 failed, 2 passed, 11 warnings in 2.18s
